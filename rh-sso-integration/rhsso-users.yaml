# Keycloak Users for AMQ Broker  
apiVersion: template.openshift.io/v1
kind: Template
labels:
  template: ${BROKER_NAME}-users-template
metadata:
  annotations:
    description: Template for ${BROKER_NAME} users 
  name: ${BROKER_NAME}-users-template
objects:
  - apiVersion: keycloak.org/v1alpha1

    kind: KeycloakUser
    metadata:
      name: admin
      labels:
        app: ${RH_SSO_NAME}
    spec:
      user:
        username: "admin"
        firstName: "Admin"
        lastName: "AMQ Brokers"
        enabled: true
        emailVerified: false
        credentials:
          - type: "password"
            value: "password"
# can define to auto-generate pass and store as secret
#            value: secret
        realmRoles:
          - "default-roles-amq-broker-realm"
        clientRoles:
          amq-broker:
            - "admin"
          amq-console:
            - "admin"
          realm-management:
            - "amq-broker-realm"
      realmSelector:
        matchLabels:
          realm: ${BROKER_NAME}-realm

  - apiVersion: keycloak.org/v1alpha1
    kind: KeycloakUser
    metadata:
      name: admin-viewer
      labels:
        app: ${RH_SSO_NAME}
    spec:
      user:
        username: "admin-viewer"
        firstName: "Admin Viewer"
        lastName: "AMQ Brokers"
        enabled: true
        emailVerified: false
        credentials:
          - type: "password"
            value: "password"
# can define to auto-generate pass and store as secret
#            value: secret
        realmRoles:
          - "default-roles-amq-broker-realm"
        clientRoles:
          amq-console:
            - "viewer"
          realm-management:
            - "amq-broker-realm"
      realmSelector:
        matchLabels:
          realm: ${BROKER_NAME}-realm

  - apiVersion: keycloak.org/v1alpha1
    kind: KeycloakUser
    metadata:
      name: application
      labels:
        app: ${RH_SSO_NAME}
    spec:
      user:
        username: "application"
        firstName: "Application"
        lastName: "User"
        enabled: true
        emailVerified: false
        credentials:
          - type: "password"
            value: "password"
# can define to auto-generate pass and store as secret
#            value: secret
        realmRoles:
          - "default-roles-amq-broker-realm"
        clientRoles:
          amq-broker:
            - "consumer"
            - "sender"
          realm-management:
            - "amq-broker-realm"
      realmSelector:
        matchLabels:
          realm: ${BROKER_NAME}-realm

parameters:
  - name: RH_SSO_NAME
    value: keycloak
  - name: BROKER_NAME
    value: my-broker
